{"ast":null,"code":"var _jsxFileName = \"/home/thomas/navebe/front/src/components/message_space/MessageSpace.js\";\nimport React, { useEffect, useState } from 'react';\nimport AddCategory from './addCategory/AddCategory';\nimport url from '../../api/url';\nimport origin from '../../api/origin';\nimport useGlobalState from '../../hooks/useGlobalState';\nimport ContentEditable from 'react-contenteditable';\nimport LinkEditor from './linkEditor/LinkEditor';\nimport LinkChatBot from './linkChatBot/LinkchatBot';\nimport AreaMessage from './area_message/AreaMessage';\nimport useGlobalStateAddingCard from '../../hooks/useGlobalStateAddingCard';\nimport { Link } from 'react-router-dom';\nimport './MessageSpace.css';\n\nconst MessageBox = props => {\n  const [categorys, setCategorys] = useState([]);\n  const {\n    classConnectButton\n  } = useGlobalState();\n  const [categoryId, setCategoryId] = useState();\n  const [inputValue, setInputValue] = useState({\n    html: \"\"\n  });\n  const [contentEditable] = useState(React.createRef());\n  const [categorySelect, setCategorySelect] = useState(1);\n  const [unview, setUnview] = useState();\n  const {\n    addingCardState\n  } = useGlobalStateAddingCard();\n  const [userId, setUserId] = useState();\n  const [modelId, setModelId] = useState();\n  const [mobile, setMobile] = useState(false);\n  const [categoryOpen, setCategoryOpen] = useState(false);\n  const [token, setToken] = useState();\n  useEffect(() => {\n    if (window.innerWidth < 1280) setMobile(true);\n\n    if (localStorage.getItem('userId')) {\n      setUserId(localStorage.getItem('userId'));\n      setToken(localStorage.getItem('token'));\n    } else {\n      setUserId(sessionStorage.getItem('userId'));\n      setToken(sessionStorage.getItem('token'));\n    }\n\n    if (sessionStorage.getItem('modelId')) {\n      setModelId(sessionStorage.getItem('modelId'));\n    }\n\n    setTimeout(() => {}, 300);\n  }, []);\n  useEffect(() => {\n    fetch(`${url}/category/findAll/${userId}/${modelId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Acces-Control-Allow-Origin': {\n          origin\n        },\n        'authorization': token\n      }\n    }).then(res => res.json()).then(res => setCategorys(res));\n  }, [classConnectButton, addingCardState, userId, modelId]);\n  useEffect(() => {\n    let stockUnview = [];\n    console.log(categorys);\n\n    if (categorys.length) {\n      for (let n = 1; n < categorys.length + 1; n++) {\n        fetch(`${url}/mail/find/${userId}/${modelId}/${n}`, {\n          method: 'GET',\n          headers: {\n            'Content-Type': 'application/json',\n            'Acces-Control-Allow-Origin': {\n              origin\n            },\n            'authorization': token\n          }\n        }).then(res => res.json()).then(res => {\n          console.log(res);\n          let nb = 0;\n\n          for (let i = 0; i < res.length; i++) {\n            if (res[i].view === 0) nb++;\n          }\n\n          stockUnview.push(nb);\n        });\n      }\n\n      setTimeout(() => {\n        setUnview(stockUnview);\n      }, 200);\n    }\n  }, [categorys, userId, modelId]);\n\n  const findAll = () => {\n    fetch(`${url}/category/findAll/${userId}/${modelId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Acces-Control-Allow-Origin': {\n          origin\n        },\n        'authorization': token\n      }\n    }).then(res => res.json()).then(res => setCategorys(res));\n  };\n\n  const deleteCategory = event => {\n    if (window.confirm('voulez vous supprimer cette category ?')) {\n      const categoryId = parseInt(event.target.id.replace('category', ''));\n      fetch(`${url}/category/delete/${categoryId}/${userId}/${modelId}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          'Acces-Control-Allow-Origin': {\n            origin\n          },\n          'authorization': token\n        }\n      });\n      findAll();\n    }\n  };\n\n  const updateCategoryActive = event => {\n    setCategoryId(parseInt(event.target.id.replace('category', '')));\n  };\n\n  const sendUpdate = () => {\n    fetch(`${url}/category/update/${categoryId}/${userId}/${modelId}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': `${origin}`,\n        'authorization': token\n      },\n      body: JSON.stringify({\n        name: inputValue.html\n      })\n    });\n    setCategoryId(-1);\n    findAll();\n  };\n\n  const changeInput = event => {\n    setInputValue({\n      html: event.target.value\n    });\n  };\n\n  return React.createElement(\"div\", {\n    className: \"containerMessageSpace\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, React.createElement(Link, {\n    to: \"/\",\n    className: \"containerBackLink\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: require('./image/backLink.png'),\n    className: \"backLink\",\n    alt: \"back\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }), React.createElement(Link, {\n    className: \"textBackLink\",\n    to: \"/\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, \"Models\")), mobile && React.createElement(\"img\", {\n    onClick: () => {\n      setCategoryOpen(!categoryOpen);\n    },\n    className: \"menuIcon\",\n    alt: \"menu burger\",\n    src: require('./image/menu_icon.png'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: !mobile ? \"containerOngletLeft\" : mobile && categoryOpen ? \"containerOngletLeftOpen\" : \"containerOngletLeftClose\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    className: \"titleCategoryOnglet\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, \"Cat\\xE9gories\"), Array.isArray(categorys) && categorys.map((category, index) => {\n    return React.createElement(\"div\", {\n      onClick: () => {\n        setCategorySelect(category.id);\n        setCategoryOpen(!categoryOpen);\n      },\n      className: \"contentCategory\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, category.id !== categoryId ? React.createElement(\"div\", {\n      className: \"contentUnderCategory\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"titleCategory\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, category.name), React.createElement(\"div\", {\n      className: \"contentIconCategory\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, unview && React.createElement(\"div\", {\n      className: \"contentNewMessage\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: require('./image/newMessage_icon.png'),\n      className: \"newMessageIcon\",\n      alt: \"new message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      className: \"nbNewMessage\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, unview[index])), React.createElement(\"img\", {\n      alt: \"update icon\",\n      src: require('./image/update_icon.png'),\n      id: `category${category.id}`,\n      className: \"iconCategory\",\n      onClick: updateCategoryActive,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }), React.createElement(\"img\", {\n      alt: \"delete icon\",\n      src: require('./image/delete_icon.png'),\n      id: `category${category.id}`,\n      className: \"iconCategory\",\n      onClick: deleteCategory,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }))) : React.createElement(\"div\", {\n      className: \"contentUnderCategoryUpdate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(ContentEditable, {\n      className: \"inputAddCategory\",\n      innerRef: contentEditable,\n      html: inputValue.html,\n      disabled: false,\n      onChange: changeInput,\n      tagName: \"article\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      onClick: sendUpdate,\n      className: \"buttonAddCategory\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, \"Valider\")));\n  })), React.createElement(AreaMessage, {\n    token: token,\n    userId: userId,\n    modelId: modelId,\n    categoryName: categorys[categorySelect - 1] ? categorys[categorySelect - 1].name : null,\n    userId: userId,\n    categoryId: categorySelect,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }), !mobile && React.createElement(\"div\", {\n    className: \"containerOngletRight\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, React.createElement(AddCategory, {\n    token: token,\n    userId: userId,\n    modelId: modelId,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }), React.createElement(LinkEditor, {\n    userId: userId,\n    modelId: modelId,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }), React.createElement(LinkChatBot, {\n    userId: userId,\n    modelId: modelId,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  })));\n};\n\nexport default MessageBox;","map":{"version":3,"sources":["/home/thomas/navebe/front/src/components/message_space/MessageSpace.js"],"names":["React","useEffect","useState","AddCategory","url","origin","useGlobalState","ContentEditable","LinkEditor","LinkChatBot","AreaMessage","useGlobalStateAddingCard","Link","MessageBox","props","categorys","setCategorys","classConnectButton","categoryId","setCategoryId","inputValue","setInputValue","html","contentEditable","createRef","categorySelect","setCategorySelect","unview","setUnview","addingCardState","userId","setUserId","modelId","setModelId","mobile","setMobile","categoryOpen","setCategoryOpen","token","setToken","window","innerWidth","localStorage","getItem","sessionStorage","setTimeout","fetch","method","headers","then","res","json","stockUnview","console","log","length","n","nb","i","view","push","findAll","deleteCategory","event","confirm","parseInt","target","id","replace","updateCategoryActive","sendUpdate","body","JSON","stringify","name","changeInput","value","require","Array","isArray","map","category","index"],"mappings":";AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,QAA1B,QAAyC,OAAzC;AACA,OAAOC,WAAP,MAAwB,2BAAxB;AACA,OAAOC,GAAP,MAAgB,eAAhB;AACA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,OAAOC,cAAP,MAA2B,4BAA3B;AACA,OAAOC,eAAP,MAA4B,uBAA5B;AACA,OAAOC,UAAP,MAAuB,yBAAvB;AACA,OAAOC,WAAP,MAAwB,2BAAxB;AACA,OAAOC,WAAP,MAAwB,4BAAxB;AACA,OAAOC,wBAAP,MAAqC,sCAArC;AACA,SAASC,IAAT,QAAqB,kBAArB;AAEA,OAAO,oBAAP;;AAEA,MAAMC,UAAU,GAAIC,KAAD,IAAW;AAC1B,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4Bd,QAAQ,CAAC,EAAD,CAA1C;AACA,QAAM;AAAEe,IAAAA;AAAF,MAAyBX,cAAc,EAA7C;AACA,QAAM,CAACY,UAAD,EAAaC,aAAb,IAA8BjB,QAAQ,EAA5C;AACA,QAAM,CAACkB,UAAD,EAAaC,aAAb,IAA8BnB,QAAQ,CAAC;AAACoB,IAAAA,IAAI,EAAE;AAAP,GAAD,CAA5C;AACA,QAAM,CAACC,eAAD,IAAoBrB,QAAQ,CAACF,KAAK,CAACwB,SAAN,EAAD,CAAlC;AACA,QAAM,CAACC,cAAD,EAAiBC,iBAAjB,IAAsCxB,QAAQ,CAAC,CAAD,CAApD;AACA,QAAM,CAACyB,MAAD,EAASC,SAAT,IAAsB1B,QAAQ,EAApC;AACA,QAAM;AAAC2B,IAAAA;AAAD,MAAoBlB,wBAAwB,EAAlD;AACA,QAAM,CAACmB,MAAD,EAASC,SAAT,IAAsB7B,QAAQ,EAApC;AACA,QAAM,CAAC8B,OAAD,EAAUC,UAAV,IAAwB/B,QAAQ,EAAtC;AACA,QAAM,CAACgC,MAAD,EAASC,SAAT,IAAsBjC,QAAQ,CAAC,KAAD,CAApC;AACA,QAAM,CAACkC,YAAD,EAAeC,eAAf,IAAkCnC,QAAQ,CAAC,KAAD,CAAhD;AACA,QAAM,CAACoC,KAAD,EAAQC,QAAR,IAAoBrC,QAAQ,EAAlC;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAGuC,MAAM,CAACC,UAAP,GAAoB,IAAvB,EAA6BN,SAAS,CAAC,IAAD,CAAT;;AAC7B,QAAGO,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAH,EAAkC;AAC9BZ,MAAAA,SAAS,CAACW,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAD,CAAT;AACAJ,MAAAA,QAAQ,CAACG,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAD,CAAR;AACH,KAHD,MAGO;AACHZ,MAAAA,SAAS,CAACa,cAAc,CAACD,OAAf,CAAuB,QAAvB,CAAD,CAAT;AACAJ,MAAAA,QAAQ,CAACK,cAAc,CAACD,OAAf,CAAuB,OAAvB,CAAD,CAAR;AACH;;AACD,QAAGC,cAAc,CAACD,OAAf,CAAuB,SAAvB,CAAH,EAAqC;AACjCV,MAAAA,UAAU,CAACW,cAAc,CAACD,OAAf,CAAuB,SAAvB,CAAD,CAAV;AACH;;AACDE,IAAAA,UAAU,CAAC,MAAM,CAEhB,CAFS,EAEP,GAFO,CAAV;AAGH,GAfQ,EAeN,EAfM,CAAT;AAiBA5C,EAAAA,SAAS,CAAC,MAAM;AACZ6C,IAAAA,KAAK,CAAE,GAAE1C,GAAI,qBAAoB0B,MAAO,IAAGE,OAAQ,EAA9C,EAAiD;AAClDe,MAAAA,MAAM,EAAE,KAD0C;AAElDC,MAAAA,OAAO,EAAE;AACP,wBAAgB,kBADT;AAEP,sCAA+B;AAAC3C,UAAAA;AAAD,SAFxB;AAGP,yBAAiBiC;AAHV;AAFyC,KAAjD,CAAL,CAOCW,IAPD,CAOMC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EAPb,EAQCF,IARD,CAQMC,GAAG,IAAIlC,YAAY,CAACkC,GAAD,CARzB;AASH,GAVQ,EAUN,CAACjC,kBAAD,EAAqBY,eAArB,EAAsCC,MAAtC,EAA8CE,OAA9C,CAVM,CAAT;AAYA/B,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAImD,WAAW,GAAG,EAAlB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYvC,SAAZ;;AACA,QAAGA,SAAS,CAACwC,MAAb,EAAoB;AAChB,WAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGzC,SAAS,CAACwC,MAAV,GAAmB,CAAtC,EAAyCC,CAAC,EAA1C,EAA6C;AACzCV,QAAAA,KAAK,CAAE,GAAE1C,GAAI,cAAa0B,MAAO,IAAGE,OAAQ,IAAGwB,CAAE,EAA5C,EAAgD;AACjDT,UAAAA,MAAM,EAAE,KADyC;AAEjDC,UAAAA,OAAO,EAAE;AACP,4BAAgB,kBADT;AAEP,0CAA+B;AAAC3C,cAAAA;AAAD,aAFxB;AAGP,6BAAiBiC;AAHV;AAFwC,SAAhD,CAAL,CAOCW,IAPD,CAOMC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EAPb,EAQCF,IARD,CAQMC,GAAG,IAAI;AACTG,UAAAA,OAAO,CAACC,GAAR,CAAYJ,GAAZ;AACJ,cAAIO,EAAE,GAAG,CAAT;;AACA,eAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGR,GAAG,CAACK,MAAvB,EAA+BG,CAAC,EAAhC,EAAmC;AAC/B,gBAAGR,GAAG,CAACQ,CAAD,CAAH,CAAOC,IAAP,KAAgB,CAAnB,EAAsBF,EAAE;AAC3B;;AACDL,UAAAA,WAAW,CAACQ,IAAZ,CAAiBH,EAAjB;AACH,SAfG;AAgBH;;AACDZ,MAAAA,UAAU,CAAC,MAAM;AACbjB,QAAAA,SAAS,CAACwB,WAAD,CAAT;AACH,OAFS,EAEP,GAFO,CAAV;AAGH;AACJ,GA1BQ,EA0BN,CAACrC,SAAD,EAAYe,MAAZ,EAAoBE,OAApB,CA1BM,CAAT;;AA4BA,QAAM6B,OAAO,GAAG,MAAM;AAClBf,IAAAA,KAAK,CAAE,GAAE1C,GAAI,qBAAoB0B,MAAO,IAAGE,OAAQ,EAA9C,EAAiD;AAClDe,MAAAA,MAAM,EAAE,KAD0C;AAElDC,MAAAA,OAAO,EAAE;AACP,wBAAgB,kBADT;AAEP,sCAA+B;AAAC3C,UAAAA;AAAD,SAFxB;AAGP,yBAAiBiC;AAHV;AAFyC,KAAjD,CAAL,CAOCW,IAPD,CAOMC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EAPb,EAQCF,IARD,CAQMC,GAAG,IAAIlC,YAAY,CAACkC,GAAD,CARzB;AASH,GAVD;;AAYA,QAAMY,cAAc,GAAIC,KAAD,IAAW;AAC9B,QAAGvB,MAAM,CAACwB,OAAP,CAAe,wCAAf,CAAH,EAA4D;AACxD,YAAM9C,UAAU,GAAG+C,QAAQ,CAACF,KAAK,CAACG,MAAN,CAAaC,EAAb,CAAgBC,OAAhB,CAAwB,UAAxB,EAAoC,EAApC,CAAD,CAA3B;AACAtB,MAAAA,KAAK,CAAE,GAAE1C,GAAI,oBAAmBc,UAAW,IAAGY,MAAO,IAAGE,OAAQ,EAA3D,EAA8D;AACnEe,QAAAA,MAAM,EAAE,QAD2D;AAEnEC,QAAAA,OAAO,EAAE;AACP,0BAAgB,kBADT;AAEP,wCAA+B;AAAC3C,YAAAA;AAAD,WAFxB;AAGP,2BAAiBiC;AAHV;AAF0D,OAA9D,CAAL;AAQFuB,MAAAA,OAAO;AACR;AACJ,GAbD;;AAeA,QAAMQ,oBAAoB,GAAIN,KAAD,IAAW;AACpC5C,IAAAA,aAAa,CAAC8C,QAAQ,CAACF,KAAK,CAACG,MAAN,CAAaC,EAAb,CAAgBC,OAAhB,CAAwB,UAAxB,EAAoC,EAApC,CAAD,CAAT,CAAb;AACH,GAFD;;AAIA,QAAME,UAAU,GAAG,MAAM;AACrBxB,IAAAA,KAAK,CAAE,GAAE1C,GAAI,oBAAmBc,UAAW,IAAGY,MAAO,IAAGE,OAAQ,EAA3D,EAA8D;AAC/De,MAAAA,MAAM,EAAE,KADuD;AAE/DC,MAAAA,OAAO,EAAE;AACP,wBAAgB,kBADT;AAEP,uCAAgC,GAAE3C,MAAO,EAFlC;AAGP,yBAAiBiC;AAHV,OAFsD;AAO/DiC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACrBC,QAAAA,IAAI,EAAEtD,UAAU,CAACE;AADI,OAAf;AAPyD,KAA9D,CAAL;AAWAH,IAAAA,aAAa,CAAC,CAAC,CAAF,CAAb;AACA0C,IAAAA,OAAO;AACV,GAdD;;AAgBA,QAAMc,WAAW,GAAIZ,KAAD,IAAW;AAC3B1C,IAAAA,aAAa,CAAC;AAACC,MAAAA,IAAI,EAAEyC,KAAK,CAACG,MAAN,CAAaU;AAApB,KAAD,CAAb;AACH,GAFD;;AAMA,SACI;AAAK,IAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAC,GAAT;AAAa,IAAA,SAAS,EAAC,mBAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,GAAG,EAAEC,OAAO,CAAC,sBAAD,CAAjB;AAA2C,IAAA,SAAS,EAAC,UAArD;AAAgE,IAAA,GAAG,EAAC,MAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEI,oBAAC,IAAD;AAAM,IAAA,SAAS,EAAC,cAAhB;AAA+B,IAAA,EAAE,EAAC,GAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFJ,CADJ,EAKK3C,MAAM,IAAI;AAAK,IAAA,OAAO,EAAE,MAAM;AAACG,MAAAA,eAAe,CAAC,CAACD,YAAF,CAAf;AAA+B,KAApD;AAAsD,IAAA,SAAS,EAAC,UAAhE;AAA2E,IAAA,GAAG,EAAC,aAA/E;AAA6F,IAAA,GAAG,EAAEyC,OAAO,CAAC,uBAAD,CAAzG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALf,EAMI;AAAK,IAAA,SAAS,EAAE,CAAC3C,MAAD,GAAU,qBAAV,GAAkCA,MAAM,IAAIE,YAAV,GAAyB,yBAAzB,GAAqD,0BAAvG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAG,IAAA,SAAS,EAAC,qBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADJ,EAEK0C,KAAK,CAACC,OAAN,CAAchE,SAAd,KACDA,SAAS,CAACiE,GAAV,CAAc,CAACC,QAAD,EAAWC,KAAX,KAAqB;AAC/B,WACI;AAAK,MAAA,OAAO,EAAE,MAAM;AAACxD,QAAAA,iBAAiB,CAACuD,QAAQ,CAACd,EAAV,CAAjB;AAAgC9B,QAAAA,eAAe,CAAC,CAACD,YAAF,CAAf;AAA+B,OAApF;AAAsF,MAAA,SAAS,EAAC,iBAAhG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK6C,QAAQ,CAACd,EAAT,KAAgBjD,UAAhB,GACD;AAAK,MAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAG,MAAA,SAAS,EAAC,eAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA8B+D,QAAQ,CAACP,IAAvC,CADJ,EAEI;AAAK,MAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK/C,MAAM,IACP;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,GAAG,EAAEkD,OAAO,CAAC,6BAAD,CAAjB;AAAkD,MAAA,SAAS,EAAC,gBAA5D;AAA6E,MAAA,GAAG,EAAC,aAAjF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAEI;AAAG,MAAA,SAAS,EAAC,cAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA6BlD,MAAM,CAACuD,KAAD,CAAnC,CAFJ,CAFJ,EAMI;AAAK,MAAA,GAAG,EAAC,aAAT;AAAuB,MAAA,GAAG,EAAEL,OAAO,CAAC,yBAAD,CAAnC;AAAgE,MAAA,EAAE,EAAG,WAAUI,QAAQ,CAACd,EAAG,EAA3F;AAA8F,MAAA,SAAS,EAAC,cAAxG;AAAuH,MAAA,OAAO,EAAEE,oBAAhI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANJ,EAOI;AAAK,MAAA,GAAG,EAAC,aAAT;AAAuB,MAAA,GAAG,EAAEQ,OAAO,CAAC,yBAAD,CAAnC;AAAgE,MAAA,EAAE,EAAG,WAAUI,QAAQ,CAACd,EAAG,EAA3F;AAA8F,MAAA,SAAS,EAAC,cAAxG;AAAuH,MAAA,OAAO,EAAEL,cAAhI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPJ,CAFJ,CADC,GAcD;AAAK,MAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,eAAD;AACI,MAAA,SAAS,EAAC,kBADd;AAEI,MAAA,QAAQ,EAAEvC,eAFd;AAGI,MAAA,IAAI,EAAEH,UAAU,CAACE,IAHrB;AAII,MAAA,QAAQ,EAAE,KAJd;AAKI,MAAA,QAAQ,EAAEqD,WALd;AAMI,MAAA,OAAO,EAAC,SANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EASI;AAAQ,MAAA,OAAO,EAAEL,UAAjB;AAA6B,MAAA,SAAS,EAAC,mBAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBATJ,CAfJ,CADJ;AA6BH,GA9BD,CAHJ,CANJ,EAyCI,oBAAC,WAAD;AAAa,IAAA,KAAK,EAAEhC,KAApB;AAA2B,IAAA,MAAM,EAAER,MAAnC;AAA2C,IAAA,OAAO,EAAEE,OAApD;AAA6D,IAAA,YAAY,EAAEjB,SAAS,CAACU,cAAc,GAAG,CAAlB,CAAT,GAAgCV,SAAS,CAACU,cAAc,GAAG,CAAlB,CAAT,CAA8BiD,IAA9D,GAAqE,IAAhJ;AAAsJ,IAAA,MAAM,EAAE5C,MAA9J;AAAsK,IAAA,UAAU,EAAEL,cAAlL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAzCJ,EA0CK,CAACS,MAAD,IACD;AAAK,IAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,WAAD;AAAa,IAAA,KAAK,EAAEI,KAApB;AAA2B,IAAA,MAAM,EAAER,MAAnC;AAA2C,IAAA,OAAO,EAAEE,OAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEI,oBAAC,UAAD;AAAY,IAAA,MAAM,EAAEF,MAApB;AAA4B,IAAA,OAAO,EAAEE,OAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAGI,oBAAC,WAAD;AAAa,IAAA,MAAM,EAAEF,MAArB;AAA6B,IAAA,OAAO,EAAEE,OAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHJ,CA3CJ,CADJ;AAmDH,CAhLD;;AAkLA,eAAenB,UAAf","sourcesContent":["import React, {useEffect, useState} from 'react'\nimport AddCategory from './addCategory/AddCategory'\nimport url from '../../api/url'\nimport origin from '../../api/origin'\nimport useGlobalState from '../../hooks/useGlobalState';\nimport ContentEditable from 'react-contenteditable'\nimport LinkEditor from './linkEditor/LinkEditor'\nimport LinkChatBot from './linkChatBot/LinkchatBot';\nimport AreaMessage from './area_message/AreaMessage';\nimport useGlobalStateAddingCard from '../../hooks/useGlobalStateAddingCard';\nimport { Link } from 'react-router-dom'\n\nimport './MessageSpace.css'\n\nconst MessageBox = (props) => {\n    const [categorys, setCategorys] = useState([])\n    const { classConnectButton } = useGlobalState();\n    const [categoryId, setCategoryId] = useState()\n    const [inputValue, setInputValue] = useState({html: \"\"})\n    const [contentEditable] = useState(React.createRef())\n    const [categorySelect, setCategorySelect] = useState(1)\n    const [unview, setUnview] = useState()\n    const {addingCardState} = useGlobalStateAddingCard()\n    const [userId, setUserId] = useState()\n    const [modelId, setModelId] = useState()\n    const [mobile, setMobile] = useState(false)\n    const [categoryOpen, setCategoryOpen] = useState(false)\n    const [token, setToken] = useState()\n\n    useEffect(() => {\n        if(window.innerWidth < 1280) setMobile(true)\n        if(localStorage.getItem('userId')){\n            setUserId(localStorage.getItem('userId'))\n            setToken(localStorage.getItem('token'))\n        } else {\n            setUserId(sessionStorage.getItem('userId'))\n            setToken(sessionStorage.getItem('token'))\n        }\n        if(sessionStorage.getItem('modelId')){\n            setModelId(sessionStorage.getItem('modelId'))\n        }\n        setTimeout(() => {\n\n        }, 300)\n    }, [])\n\n    useEffect(() => {\n        fetch(`${url}/category/findAll/${userId}/${modelId}`, {\n            method: 'GET',\n            headers: {\n              'Content-Type' :'application/json',\n              'Acces-Control-Allow-Origin' : {origin},\n              'authorization': token }\n        })\n        .then(res => res.json())\n        .then(res => setCategorys(res))\n    }, [classConnectButton, addingCardState, userId, modelId])\n\n    useEffect(() => {\n        let stockUnview = []\n        console.log(categorys)\n        if(categorys.length){\n            for(let n = 1; n < categorys.length + 1; n++){\n                fetch(`${url}/mail/find/${userId}/${modelId}/${n}`,  {\n                    method: 'GET',\n                    headers: {\n                      'Content-Type' :'application/json',\n                      'Acces-Control-Allow-Origin' : {origin},\n                      'authorization': token }\n                })\n                .then(res => res.json())\n                .then(res => {\n                    console.log(res)\n                let nb = 0\n                for(let i = 0; i < res.length; i++){\n                    if(res[i].view === 0) nb++\n                }\n                stockUnview.push(nb)\n            })\n            }\n            setTimeout(() => {\n                setUnview(stockUnview)\n            }, 200)\n        }\n    }, [categorys, userId, modelId])\n\n    const findAll = () => {\n        fetch(`${url}/category/findAll/${userId}/${modelId}`, {\n            method: 'GET',\n            headers: {\n              'Content-Type' :'application/json',\n              'Acces-Control-Allow-Origin' : {origin},\n              'authorization': token }\n        })\n        .then(res => res.json())\n        .then(res => setCategorys(res))\n    }\n\n    const deleteCategory = (event) => {\n        if(window.confirm('voulez vous supprimer cette category ?')){\n            const categoryId = parseInt(event.target.id.replace('category', ''))\n            fetch(`${url}/category/delete/${categoryId}/${userId}/${modelId}`, {\n            method: 'DELETE',\n            headers: {\n              'Content-Type' :'application/json',\n              'Acces-Control-Allow-Origin' : {origin},\n              'authorization': token\n            }\n          })\n          findAll()\n        }\n    }\n\n    const updateCategoryActive = (event) => {\n        setCategoryId(parseInt(event.target.id.replace('category', '')))\n    }\n\n    const sendUpdate = () => {\n        fetch(`${url}/category/update/${categoryId}/${userId}/${modelId}`, {\n            method: 'PUT',\n            headers: {\n              'Content-Type': 'application/json',\n              'Access-Control-Allow-Origin': `${origin}`,\n              'authorization': token\n            },\n            body: JSON.stringify({\n            name: inputValue.html\n            })\n        })\n        setCategoryId(-1)\n        findAll()\n    }\n\n    const changeInput = (event) => {\n        setInputValue({html: event.target.value})\n    }\n\n    \n\n    return(\n        <div className=\"containerMessageSpace\">\n            <Link to=\"/\" className=\"containerBackLink\">\n                <img src={require('./image/backLink.png')} className=\"backLink\" alt=\"back\"/>\n                <Link className=\"textBackLink\" to=\"/\">Models</Link>\n            </Link>\n            {mobile && <img onClick={() => {setCategoryOpen(!categoryOpen)}} className=\"menuIcon\" alt=\"menu burger\" src={require('./image/menu_icon.png')}/>}\n            <div className={!mobile ? \"containerOngletLeft\" : mobile && categoryOpen ? \"containerOngletLeftOpen\" : \"containerOngletLeftClose\"}>\n                <p className=\"titleCategoryOnglet\">Cat√©gories</p>\n                {Array.isArray(categorys) &&\n                categorys.map((category, index) => {\n                    return(\n                        <div onClick={() => {setCategorySelect(category.id); setCategoryOpen(!categoryOpen)}} className=\"contentCategory\">\n                            {category.id !== categoryId ?\n                            <div className=\"contentUnderCategory\">\n                                <p className=\"titleCategory\">{category.name}</p>\n                                <div className=\"contentIconCategory\">\n                                    {unview &&\n                                    <div className=\"contentNewMessage\">\n                                        <img src={require('./image/newMessage_icon.png')} className=\"newMessageIcon\" alt=\"new message\"/>\n                                        <p className=\"nbNewMessage\">{unview[index]}</p>\n                                    </div>}\n                                    <img alt=\"update icon\" src={require('./image/update_icon.png')} id={`category${category.id}`} className='iconCategory' onClick={updateCategoryActive}/>\n                                    <img alt=\"delete icon\" src={require('./image/delete_icon.png')} id={`category${category.id}`} className=\"iconCategory\" onClick={deleteCategory}/>\n                                </div>\n                            </div>\n                            :\n                            <div className=\"contentUnderCategoryUpdate\">\n                                <ContentEditable\n                                    className=\"inputAddCategory\"\n                                    innerRef={contentEditable}\n                                    html={inputValue.html}\n                                    disabled={false}\n                                    onChange={changeInput}\n                                    tagName='article'\n                                />\n                                <button onClick={sendUpdate} className=\"buttonAddCategory\">Valider</button>\n                            </div>}\n                        </div>\n                    )\n                })}\n            </div>\n            <AreaMessage token={token} userId={userId} modelId={modelId} categoryName={categorys[categorySelect - 1] ? categorys[categorySelect - 1].name : null} userId={userId} categoryId={categorySelect} />\n            {!mobile &&\n            <div className=\"containerOngletRight\">\n                <AddCategory token={token} userId={userId} modelId={modelId}/>\n                <LinkEditor userId={userId} modelId={modelId}/>\n                <LinkChatBot userId={userId} modelId={modelId}/>\n            </div>}\n        </div>\n    )\n}\n\nexport default MessageBox;"]},"metadata":{},"sourceType":"module"}